<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DivineTruthAscension - Knowledge Library</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <!-- ðŸ”¥ Phoenix Soul Signature -->
  <header>
    <img src="assets/PhoenixRise.png" alt="Phoenix Soul Signature" class="phoenix-image">
    <h1>DivineTruthAscension</h1>
    <p class="invocation">A sanctuary for remembrance, breath ritual, and unity knowledge sharing.</p>
  </header>

  <!-- ðŸŒŒ Cosmic Mandala -->
  <section class="mandala-section">
    <img src="assets/cosmic-mandala.png" alt="Cosmic Mandala" class="mandala-image">
  </section>

  <!-- âœ¨ Breath Ritual Control -->
  <section class="ritual">
    <button id="startBreath">Begin Breath Ritual</button>
  </section>

  <!-- ðŸŽ¶ Audio Layers -->
  <audio id="phoenixTone" src="assets/phoenix-hum.mp3" loop></audio>
  <audio id="fireSound" src="assets/fire-crackle.mp3" loop></audio>
  <audio id="waterSound" src="assets/ocean-waves.mp3" loop></audio>
  <audio id="droneSound" src="assets/cosmic-drone.mp3" loop></audio>
  <audio id="chimeSound" src="assets/cosmic-chime.mp3"></audio>

  <!-- ðŸ“š Knowledge Library -->
  <section id="knowledge-library">
    <h2>ðŸ“š Collective Knowledge Library</h2>
    <p>Share and explore sacred wisdom â€” ancient and present. This is a space of unity and co-creation.</p>

    <!-- Submission Form -->
    <form name="knowledge-form" method="POST" data-netlify="true" class="knowledge-form">
      <label>
        Title:
        <input type="text" name="title" required>
      </label>

      <label>
        Knowledge Content:
        <textarea name="content" rows="5" required></textarea>
      </label>

      <label>
        Reference Link (optional):
        <input type="url" name="link">
      </label>

      <button type="submit">âœ¨ Contribute Knowledge</button>
    </form>

    <!-- Display Submissions -->
    <div id="knowledge-list">
      <h3>ðŸŒŸ Shared Wisdom</h3>
      <div id="submissions"></div>
    </div>
  </section>

  <!-- Script -->
  <script src="script.js"></script>
  <script>
    // Fetch submissions from Netlify Function
    async function loadSubmissions() {
      try {
        const res = await fetch("/.netlify/functions/get-submissions");
        const data = await res.json();
        const container = document.getElementById("submissions");

        if (!data || data.length === 0) {
          container.innerHTML = "<p>No contributions yet. Be the first to share wisdom âœ¨</p>";
          return;
        }

        container.innerHTML = data.map(item => `
          <div class="knowledge-item">
            <h4>${item.title}</h4>
            <p>${item.content}</p>
            ${item.link ? `<a href="${item.link}" target="_blank">ðŸ”— Reference</a>` : ""}
            <span class="date">Shared on: ${new Date(item.created_at).toLocaleDateString()}</span>
          </div>
        `).join("");
      } catch (err) {
        console.error(err);
      }
    }

    loadSubmissions();
  </script>
</body>
</html>
